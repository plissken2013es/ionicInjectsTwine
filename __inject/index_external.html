<!DOCTYPE html>
<html>
    <head>
        <title>La cuenta atrás</title>
        <meta charset=utf-8>
        <!--<meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *">-->
        <meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval'">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
                
        <!--<script src="http://192.168.1.34:8080/target/target-script-min.js#anonymous"></script>-->
        <style>
            a,body{color:#222}
            body{font:18px "Helvetica Neue",Helvetica,Arial,sans-serif}
            #passage{max-width:38em;margin:0 auto;line-height:145%}
            
            a{text-decoration:none;border-bottom:2px solid #bbb}
            a:hover{color:#cc8929;border-color:#cc8929}
            a:active{color:#ffb040;border-color:#ffb040}
            tw-storydata{display:none}
            @media screen and (max-device-width:480px){
                #passage{font-size:70%}
            }
        </style>
        
        <script src="css/styles.js"></script>
    </head>

    <body>
        <div id="passage"></div>
        
        <tw-storydata name="La cuenta atrás" startnode="1" creator="Twine" creator-version="2.0.10" ifid="D1363650-EE8A-4A4C-AE42-C5D1FCB43F63" format="Snowman" options="" hidden>
       
        <!--<script src="js/lib.js"></script>-->
        <!--<script src="js/luisquin.js"></script>-->
        <script>
            var rawFile = new XMLHttpRequest();
            rawFile.open('GET', 'data/story.txt');
            rawFile.onreadystatechange = function() {
                if(rawFile.readyState === 4) {
                    if(rawFile.status === 200 || rawFile.status == 0) {
                        // append styles
                        var targetEl = document.getElementsByTagName("tw-storydata")[0];
                        targetEl.innerHTML = rawFile.responseText;
                                                
                        var rawFile2 = new XMLHttpRequest();
                        rawFile2.open("GET", "css/styles.txt");
                        rawFile2.onreadystatechange = function() {
                            if (rawFile2.readyState === 4) {
                                if (rawFile2.satus === 200 || rawFile2.status === 0) {
                                    // append styles
                                    var targetEl = document.getElementsByTagName("tw-storydata")[0];
                                    scriptToLoad = document.createElement("style");
                                    scriptToLoad.type = "text/twine-css";
                                    scriptToLoad.role = "stylesheet";
                                    scriptToLoad.id = "twine-user-stylesheet";
                                    scriptToLoad.innerHTML = rawFile2.responseText;
                                    targetEl.appendChild(scriptToLoad);
                                    
                                    setTimeout(function() {
                                        // append javascript
                                        scriptToLoad = document.createElement("script");
                                        scriptToLoad.src = "js/lib.js";
                                        targetEl.appendChild(scriptToLoad);

                                        scriptToLoad = document.createElement("script");
                                        scriptToLoad.src = "js/luisquin.js";
                                        targetEl.appendChild(scriptToLoad);

                                        scriptToLoad = document.createElement("script");
                                        scriptToLoad.type = "text/twine-javascript";
                                        scriptToLoad.role = "script";
                                        scriptToLoad.id = "twine-user-script";
                                        scriptToLoad.src = "js/luisquin.js";
                                        targetEl.appendChild(scriptToLoad);
                                    }.bind(this), 250);
                                }
                            }
                        };
                        rawFile2.send();
                    }
                        /*var targetEl = document.getElementsByTagName("tw-storydata")[0];
                        targetEl.innerHTML = rawFile.responseText;
                        var scriptToLoad = document.createElement("script");
                        scriptToLoad.src = "js/lib.js";
                        targetEl.appendChild(scriptToLoad);

                        // append styles
                        scriptToLoad = document.createElement("style");
                        scriptToLoad.type = "text/twine-css";
                        scriptToLoad.role = "stylesheet";
                        scriptToLoad.id = "twine-user-stylesheet";
                        scriptToLoad.innerHTML = minifiedCSS;
                        targetEl.appendChild(scriptToLoad);

                        // append javascript
                        scriptToLoad = document.createElement("script");
                        scriptToLoad.src = "js/luisquin.js";
                        targetEl.appendChild(scriptToLoad);
                        
                        scriptToLoad = document.createElement("script");
                        scriptToLoad.type = "text/twine-javascript";
                        scriptToLoad.role = "script";
                        scriptToLoad.id = "twine-user-script";
                        scriptToLoad.src = "js/luisquin.js";
                        targetEl.appendChild(scriptToLoad);*/
                }
            };
            rawFile.send();
        </script>  
              
        </tw-storydata>
    </body>
</html>